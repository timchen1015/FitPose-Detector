# FitPose-Detector

A real-time exercise pose detection system based on MediaPipe and LSTM, capable of recognizing different exercise movements including push-ups, squats, and sit-ups.

[![FitPose Detector Demo](https://img.youtube.com/vi/UjlId3CEh6U/0.jpg)](https://youtu.be/UjlId3CEh6U?si=oL9TPSlOcomv-AIG)
*Click on the image above to watch the demo video*

![Training Performance](https://github.com/timchen1015/FitPose-Detector/raw/main/trained_pose_model/training_history.png)

## Features

- Real-time pose detection and tracking
- Recognition of three different exercises:
  - Push-ups
  - Squats
  - Sit-ups
- LSTM deep learning model for accurate movement classification
- Live skeleton tracking visualization
- Real-time display of recognition results with confidence scores

## Installation

### Prerequisites

- Python 3.8+ (recommended)
- Webcam for real-time detection

### Steps to Install

1. Clone this repository:
   ```bash
   git clone https://github.com/timchen1015/FitPose-Detector.git
   cd FitPose-Detector
   ```

2. Install required dependencies:
   ```bash
   pip install -r requirements.txt
   ```

   Required packages:
   - tensorflow>=2.13.0
   - mediapipe==0.10.14
   - opencv-python>=4.8.0
   - numpy>=1.24.0
   - scikit-learn>=1.0.0
   - matplotlib>=3.7.0

## Usage

### Running the Exercise Recognition System

To start the real-time exercise recognition:

```bash
python main.py
```

This will:
1. Open your webcam
2. Detect and track your body movements
3. Recognize and classify exercises in real-time
4. Display the detected exercise type and confidence score

### Creating Your Own Dataset

If you want to create your own exercise dataset, you can:

1. Prepare video recordings of each exercise type
2. Use the provided video frame extraction tool:

```bash
python exercise_dataset/extract_video.py
```

This will process your videos and extract frames for training.

### Training the Model with Your Data

To train the model with your own dataset:

```bash
python trained_pose_model/train_model.py
```

## Project Structure

```
project_root/
│
├── main.py                  # Main application for real-time detection
├── requirements.txt         # Required Python packages
│
├── trained_pose_model/      # Pre-trained model files
│   ├── train_model.py       # Script for training the model
│   ├── best_model.keras     # Trained LSTM model
│   ├── label_encoder.npy    # Class labels for exercises
│   └── training_history.png # Model training performance
│
└── exercise_dataset/        # Dataset folder 
    ├── extract_video.py     # Script to extract frames from videos
    ├── image_dataset/       # Processed image frames for training (generated by extract_video.py)
    └── video_dataset/       # Raw video datasets
        ├── push_up_video/   # Push-up exercise videos
        ├── sit_up_video/    # Sit-up exercise videos
        └── squat_video/     # Squat exercise videos
```

## Dataset

Due to GitHub file size limitations, the video dataset files are not included in this repository. Instead, you can access and download them from this Google Drive link:

[Download Video Dataset](https://drive.google.com/drive/folders/1R5GQuEyEbXMzfJ7bL3dZY9X_9ZQsn-X3?usp=sharing)

After downloading:
1. Place the video files in the appropriate folders under `exercise_dataset/video_dataset/`
2. The image frames used for training are not included due to their large size (approximately 20GB)
3. You need to extract frames from the downloaded video files using the included script

### Processing Video Dataset

To prepare the dataset for training:

1. First, make sure you've downloaded the video dataset from the [Google Drive link](https://drive.google.com/drive/folders/1R5GQuEyEbXMzfJ7bL3dZY9X_9ZQsn-X3?usp=sharing)
2. Place the videos in the corresponding folders under `exercise_dataset/video_dataset/`
3. Run the frame extraction script:

```bash
# Run the frame extraction script
python exercise_dataset/extract_video.py
```

This script will:
- Process all videos in the push_up_video, sit_up_video, and squat_video folders
- Extract frames at 10 FPS
- Save the frames to the image_dataset directory with proper organization
- Create all necessary folders automatically if they don't exist

You can also:
- Use your own exercise videos by placing them in the appropriate folders
- Modify the extraction parameters in the script if needed

## Demo

Check out our demonstration video to see FitPose-Detector in action:

[![FitPose Detector Demo Video](https://img.youtube.com/vi/UjlId3CEh6U/0.jpg)](https://youtu.be/UjlId3CEh6U?si=oL9TPSlOcomv-AIG)

The demo shows:
- Real-time detection of push-ups, squats, and sit-ups
- Skeleton tracking and visualization
- Exercise classification with confidence scores
- Performance in different lighting conditions and angles

## Contact

For questions or collaboration opportunities, please reach out to [timchen1015](https://github.com/timchen1015).
